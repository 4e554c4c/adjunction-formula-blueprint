\section{Completions of locally constant functions}

\begin{definition}
  \label{CLC}
  \lean{NormedGroup.LCC}
  \leanok
  Let $V$ be a semi-normed group, and $X$ a compact topological space.
  We denote by $V(X)$ the normed abelian group of locally constant functions $X \to V$
  with respect to the sup norm.
  With $\hat V(X)$ we denote the completion of $V(X)$.

  These constructions are functorial in bounded group homomorphisms $V \to V'$
  and contravariantly functorial in continuous maps $f \colon X \to X'$.

  Note in particular that $V(f)$ and $\hat V(f)$ are norm-nonincreasing
  morphisms of semi-normed groups.
\end{definition}

\begin{lemma}
  \label{CLC_normed_with_aut}
  \lean{NormedGroup.normed_with_aut_LCC}
  \leanok
  \uses{CLC, normed_with_aut}
  Let $r \in \mathbb R_{> 0}$,
  and let $V$ be an $r$-normed $\mathbb Z[T^{\pm 1}]$-module.
  Let $X$ be a compact space.
  Then $\hat V(X)$ is naturally an $r$-normed $\mathbb Z[T^{\pm 1}]$-module,
  with the action of $T$ given by post-composition.
\end{lemma}

\begin{proof}
  \leanok
  Formalised, but omitted from this text.
\end{proof}

We continue to use the notation of before:
let $r' > 0, c \ge 0$ be real numbers,
and let $M$ be a profinitely filtered pseudo-normed group with $r'$-action by $T^{-1}$
(see Section~\ref{sec:normed_groups}).

\begin{lemma}
  \label{basic_eval_FP}
  \lean{breen_deligne.basic_universal_map.eval_FP}
  \lean{breen_deligne.basic_universal_map.eval_FP_comp}
  \leanok
  \uses{profinitely_filtered_pseudo_normed_group_with_Tinv,
    basic_universal_map}
  Let $f$ be a basic universal map from exponent~$m$ to~$n$.
  We get an induced homomorphism of
  profinitely filtered pseudo-normed groups $M^m \to M^n$
  bounded by the maximum (over all $i$) of $\sum_j |f_{ij}|$,
  where the $f_{ij}$ are the coefficients of the $n \times m$-matrix representing~$f$.

  This construction is functorial in~$f$.
\end{lemma}

\begin{proof}
  \leanok
  Omitted.
\end{proof}

\begin{definition}
  \label{basic_eval_LCFP}
  \lean{breen_deligne.basic_universal_map.eval_LCFP}
  \lean{breen_deligne.basic_universal_map.eval_LCFP_comp}
  \leanok
  \uses{basic_universal_suitable, basic_eval_FP}
  Let $f$ be a basic universal map from exponent~$m$ to~$n$,
  and let $(c_2, c_1)$ be $f$-suitable.
  We get an induced map
  \[
    V(f) \colon V(M_{\le c_1}^n) \to V(M_{\le c_2}^m)
  \]
  induced by the morphism of profinitely filtered pseudo-normed groups $M^m \to M^n$.

  This construction is functorial in~$f$.
\end{definition}

\begin{definition}
  \label{eval_LCFP}
  \lean{breen_deligne.universal_map.eval_LCFP}
  \lean{breen_deligne.universal_map.eval_LCFP_comp}
  \leanok
  \uses{universal_suitable, basic_eval_LCFP}
  Let $f = \sum_g n_g g$ be a universal map from exponent~$m$ to~$n$,
  and let $(c_2, c_1)$ be $f$-suitable.
  We get an induced map
  \[
    V(f) \colon V(M_{\le c_1}^n) \to V(M_{\le c_2}^m)
  \]
  that is the sum $\sum n_g V(g)$.

  This construction is functorial in~$f$.
\end{definition}

\begin{definition}
  \label{eval_CLCFP}
  \lean{breen_deligne.universal_map.eval_CLCFP}
  \leanok
  \uses{universal_suitable, eval_LCFP}
  Let $f$ be a universal map from exponent~$m$ to~$n$,
  and let $(c_2, c_1)$ be $f$-suitable.
  We get an induced map
  \[
    \hat V(f) \colon \hat V(M_{\le c_1}^n) \to \hat V(M_{\le c_2}^m)
  \]
  that is the completion of $V(f)$.

  This construction is functorial in~$f$.
\end{definition}

Let $r > 0$, and assume now that $V$ is an $r$-normed $\mathbb Z[T^{\pm 1}]$-module.
Assume $r' \le 1$.

\begin{definition}
  \label{CLCFPTinv}
  \lean{CLCFPTinv}
  \leanok
  \uses{CLC_normed_with_aut}
  There are two natural actions of $T^{-1}$ on $\hat V(M_{\le c})$.
  The first comes from the $r'$-action of $T^{-1}$ on $M$
  which gives a continuous map
  \[
    M_{\le cr'} \to M_{\le c}
  \]
  and thus a map
  \[
    (T^{-1})^* \colon \hat V(M_{\le c}) \to \hat V(M_{\le cr'}).
  \]
  The other comes from Lemma~\ref{CLC_normed_with_aut},
  using the $r$-normed $\mathbb Z[T^{\pm 1}]$-module $V$.
  We get a map
  \[
    [T^{-1}] \colon \hat V(M_{\le c}) \to \hat V(M_{\le c}),
  \]
  that we can compose with the map
  $\hat V(M_{\le c}) \to \hat V(M_{\le cr'})$,
  obtained from the natural inclusion $M_{\le cr'} \to M_{\le c}$.
  We thus end up with two maps
  \[
    (T^{-1})^*, [T^{-1}] \colon \hat V(M_{\le c}) \to \hat V(M_{\le cr'}).
  \]
  and we define $\hat V(M_{\le c})^{T^{-1}}$
  to be the equalizer of $(T^{-1})^*$ and $[T^{-1}]$.
  In other words, the kernel of $(T^{-1})^* - [T^{-1}]$.
\end{definition}

\begin{definition}
  \label{eval_CLCFPTinv}
  \lean{breen_deligne.universal_map.eval_CLCFPTinv}
  \leanok
  \uses{CLCFPTinv, eval_CLCFP}
  Let $f$ be a universal map from exponent~$m$ to~$n$,
  and let $(c_2, c_1)$ be $f$-suitable.

  The natural map from Definition~\ref{eval_CLCFP}
  restricts to a map
  \[
    \hat V(f)^{T^{-1}} \colon \hat V(M_{\le c_1}^n)^{T^{-1}} \to \hat V(M_{\le c_2}^m)^{T^{-1}}
  \]
\end{definition}

\begin{lemma}
  \label{eval_CLCFPTinv_norm_noninc}
  \lean{breen_deligne.universal_map.eval_CLCFPTinv_norm_noninc}
  \uses{eval_CLCFPTinv, very_suitable}
  \leanok
  Let $0 < r$ and $0 < r' \le 1$ be real numbers.
  Let $f$ be a universal map from exponent~$m$ to~$n$,
  and let $(c_2, c_1)$ be very suitable for $(f, r, r')$.
  Then
  \[
    \hat V(f)^{T^{-1}} \colon \hat V(M_{\le c_1}^n)^{T^{-1}} \to \hat V(M_{\le c_2}^m)^{T^{-1}}
  \]
  is norm-nonincreasing.
\end{lemma}

\begin{proof}
  \leanok
  Use the assumption that $(c_2, c_1)$ is very suitable for $(f, r, r')$
  in order to find $N, b \in \N$ and $c' \in \R_{\ge 0}$ such that:
  \begin{itemize}
    \item $f$ is bound by $N$ (see Definition~\ref{universal_map_bound_by})
    \item $(c_2, c')$ is $f$-suitable
    \item $r ^ b N ≤ 1$
    \item $c' ≤ (r') ^ b c_1$
  \end{itemize}
  Now, notice that the norm of $\hat V(f)$ is at most $N$,
  and $\hat V(f)$ can be factored as
  \begin{center}
    \begin{tikzcd}
      \hat V(M_{\le c_1}^n)^{T^{-1}}
      \rar{\mathrm{res}} &
      \hat V(M_{\le c' }^n)^{T^{-1}}
      \rar{\hat V(f)} &
      \hat V(M_{\le c_2}^m)^{T^{-1}}
    \end{tikzcd}
  \end{center}
  Now use the defining property of the equalizer to conclude that
  the restriction map has norm less than $1/N$,
  and therefore the composition is norm-nonincreasing.
\end{proof}

\begin{definition}
  \label{BD_system}
  \lean{breen_deligne.data.system}
  \lean{breen_deligne.data.system_admissible}
  \leanok
  \uses{BD_very_suitable, eval_CLCFPTinv_norm_noninc, system_of_complexes,
    admissible}
  Let $0 < r$ and $0 < r' \le 1$ be real numbers,
  and let $V$ be an $r$-normed $\mathbb Z[T^{\pm 1}]$-module.
  Let $\BD = (n,f)$ be Breen--Deligne data,
  and let $\kappa = (\kappa_0, \kappa_1, \kappa_2, \dots)$
  be a sequence of constants in $\mathbb R_{\ge 0}$
  that is very suitable for $(\BD, r, r')$.
  Let $M$ be a profinitely filtered pseudo-normed group with $r'$-action of $T^{-1}$.

  For every $c \in \mathbb R_{\ge 0}$,
  the maps from Definition~\ref{eval_CLCFPTinv}
  induced by the universal maps $f_i$ from the Breen--Deligne $\BD = (n,f)$
  assemble into a complex of normed abelian groups
  \[
    C^{\text{BD}}_{\kappa}(M)_c^\bullet \colon
    \dots \to
    \hat V(M_{\le \kappa_i}^{n_i})^{T^{-1}}
    \to
    \hat V(M_{\le \kappa_{i+1}}^{n_{i+1}})^{T^{-1}}
    \to \dots \to 0.
  \]
  Together, these complexes fit into a system of complexes
  with the natural restriction maps.

  By Lemma~\ref{eval_CLCFPTinv_norm_noninc} the differentials are norm-nonincreasing.
  It is clear that the restriction maps are also norm-nonincreasing,
  and therefore the system is admissible.
\end{definition}

% vim: ts=2 et sw=2 sts=2
